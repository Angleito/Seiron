<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Model File Fetch Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #333;
        }
        .success {
            background-color: #0f4c3a;
            border-color: #28a745;
        }
        .error {
            background-color: #4c0f0f;
            border-color: #dc3545;
        }
        .pending {
            background-color: #3a3a0f;
            border-color: #ffc107;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
        pre {
            background: #2a2a2a;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Model File Fetch Test</h1>
        <p>This test validates that model files can be fetched from JavaScript.</p>
        
        <button onclick="runAllTests()">Run All Tests</button>
        <button onclick="clearResults()">Clear Results</button>
        
        <div id="results"></div>
    </div>

    <script>
        const modelFiles = [
            '/models/seiron_animated.gltf',
            '/models/seiron_animated.bin', 
            '/models/dragon_head.glb',
            '/models/seiron.glb',
            '/models/seiron_optimized.glb'
        ];

        async function testModelFetch(modelPath) {
            const resultDiv = document.createElement('div');
            resultDiv.className = 'test-result pending';
            resultDiv.innerHTML = `<strong>Testing: ${modelPath}</strong><br>Status: Fetching...`;
            document.getElementById('results').appendChild(resultDiv);

            try {
                const startTime = performance.now();
                const response = await fetch(modelPath);
                const endTime = performance.now();
                const duration = (endTime - startTime).toFixed(2);

                if (response.ok) {
                    const contentLength = response.headers.get('content-length');
                    const contentType = response.headers.get('content-type');
                    const corsOrigin = response.headers.get('access-control-allow-origin');
                    
                    resultDiv.className = 'test-result success';
                    resultDiv.innerHTML = `
                        <strong>✅ SUCCESS: ${modelPath}</strong><br>
                        Status: ${response.status} ${response.statusText}<br>
                        Content-Type: ${contentType}<br>
                        Content-Length: ${contentLength ? (parseInt(contentLength) / 1024).toFixed(2) + ' KB' : 'Unknown'}<br>
                        CORS Origin: ${corsOrigin || 'Not set'}<br>
                        Fetch Time: ${duration}ms<br>
                        <details>
                            <summary>Response Headers</summary>
                            <pre>${Array.from(response.headers.entries()).map(([k, v]) => `${k}: ${v}`).join('\\n')}</pre>
                        </details>
                    `;
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                resultDiv.className = 'test-result error';
                resultDiv.innerHTML = `
                    <strong>❌ FAILED: ${modelPath}</strong><br>
                    Error: ${error.message}<br>
                    Type: ${error.name}<br>
                    Stack: <pre>${error.stack}</pre>
                `;
            }
        }

        async function runAllTests() {
            clearResults();
            document.getElementById('results').innerHTML = '<h2>Test Results:</h2>';
            
            for (const modelPath of modelFiles) {
                await testModelFetch(modelPath);
                // Add small delay between tests
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            
            // Test direct browser access
            const directTestDiv = document.createElement('div');
            directTestDiv.className = 'test-result';
            directTestDiv.innerHTML = `
                <strong>Direct Browser Access Test:</strong><br>
                <p>Click the links below to test direct browser access:</p>
                ${modelFiles.map(path => `<a href="${path}" target="_blank" style="color: #66ccff; margin-right: 10px;">${path}</a>`).join('<br>')}
            `;
            document.getElementById('results').appendChild(directTestDiv);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        // Run tests on page load
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 500);
        });
    </script>
</body>
</html>